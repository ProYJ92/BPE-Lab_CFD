# .github/workflows/deploy_static.yml
name: Deploy Static Site to GitHub Pages ğŸš€

on:
  # main ë¸Œëœì¹˜ ë¨¸ì§€(push) â†’ ë¹Œë“œÂ·ë°°í¬
  push:
    branches: [main]

  # PR ìƒì„±Â·ìˆ˜ì • â†’ ë¹Œë“œ(ê²€ì¦)ë§Œ ìˆ˜í–‰
  pull_request:
    branches: [main]

  # ìˆ˜ë™ ì‹¤í–‰
  workflow_dispatch:

permissions:
  contents: read          # ì½”ë“œ ì½ê¸°
  pages:    write         # Pages ë°°í¬
  id-token: write         # OIDC ì„œëª…

concurrency:
  group: pages-static     # ì¤‘ë³µ ëŒ€ê¸°ì—´ ë°©ì§€
  cancel-in-progress: false

jobs:
  # ---------- Build ----------
  build:
    runs-on: ubuntu-latest
    env:
      JEKYLL_ENV: production
    steps:
      - name: â¬‡ï¸ Checkout
        uses: actions/checkout@v4

      - name: ğŸ“„ Ensure .nojekyll
        run: touch .nojekyll       # Jekyll ë³€í™˜ ë°©ì§€

      - name: âš™ï¸ Setup Pages
        uses: actions/configure-pages@v5

      - name: ğŸ“¤ Upload artifact
        uses: actions/upload-pages-artifact@v3
        with:
          path: ./                 # ì €ì¥ì†Œ ë£¨íŠ¸ ì „ì²´ ì—…ë¡œë“œ

  # ---------- Deploy ----------
  deploy:
    if: github.event_name == 'push'  # PR ë¹Œë“œ ë•ŒëŠ” ê±´ë„ˆëœ€
    needs: build
    runs-on: ubuntu-latest
    environment:
      name: github-pages
      url: ${{ steps.deploy.outputs.page_url }}
    steps:
      - name: ğŸš€ Deploy to GitHub Pages
        id: deploy
        uses: actions/deploy-pages@v4
